<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- Generated by perltidy on Tue May 14 16:52:48 2024 -->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>codes-poker.pl</title>
<link rel="stylesheet" href="style.css" type="text/css" /></head>
<body>
<a name="-top-"></a>
<h1>codes-poker.pl</h1>
<!-- BEGIN CODE INDEX --><a name="code-index"></a>
<ul>
<li><a href="#hand-">package main</a>
<ul>
<li><a href="#hand-">hand</a></li>
<li><a href="#longest_seq-">longest_seq</a></li>
<li><a href="#random_code-">random_code</a></li>
<li><a href="#random_int_between-">random_int_between</a></li>
</ul>
</li>
<li><a href="#EOF-">EOF</a></li>
</ul>
<!-- END CODE INDEX -->
<hr />
<!-- contents of filename: codes-poker.pl -->
<pre>
#! perl
<span class="c">#</span>
<span class="k">use</span> <span class="v">v5.036</span><span class="sc">;</span>
<span class="k">use</span> <span class="w">String::LCSS</span> <span class="q">&quot;lcss&quot;</span><span class="sc">;</span>
<span class="c"># no longer need use experimental  &#39;signatures&#39;;</span>


<span class="c">## To test whether 6 digit confirm codes are likely to have a pattern</span>
<span class="c">#</span>

<span class="k">my</span> <span class="i">$N</span> = <span class="n">1000</span><span class="sc">;</span>

<span class="k">my</span> <span class="i">@Samples</span>=<span class="s">(</span>  <span class="c">## calibration samples</span>
    <span class="s">[</span><span class="n">1</span><span class="cm">,</span> <span class="n">2</span><span class="cm">,</span> <span class="n">3</span><span class="cm">,</span> <span class="n">4</span><span class="cm">,</span> <span class="n">5</span><span class="cm">,</span> <span class="n">5</span><span class="s">]</span><span class="cm">,</span>
    <span class="s">[</span><span class="n">1</span><span class="cm">,</span> <span class="n">2</span><span class="cm">,</span> <span class="n">3</span><span class="cm">,</span> <span class="n">1</span><span class="cm">,</span> <span class="n">2</span><span class="cm">,</span> <span class="n">3</span><span class="s">]</span><span class="cm">,</span>
    <span class="s">[</span><span class="n">1</span><span class="cm">,</span> <span class="n">2</span><span class="cm">,</span> <span class="n">3</span><span class="cm">,</span> <span class="n">4</span><span class="cm">,</span> <span class="n">5</span><span class="cm">,</span> <span class="n">6</span><span class="s">]</span><span class="cm">,</span>
    <span class="s">[</span><span class="n">2</span><span class="cm">,</span> <span class="n">4</span><span class="cm">,</span> <span class="n">6</span><span class="cm">,</span> <span class="n">8</span><span class="cm">,</span> <span class="n">9</span><span class="cm">,</span> <span class="n">0</span><span class="s">]</span><span class="cm">,</span>
    <span class="s">[</span><span class="n">2</span><span class="cm">,</span> <span class="n">4</span><span class="cm">,</span> <span class="n">6</span><span class="cm">,</span> <span class="n">8</span><span class="cm">,</span> <span class="n">7</span><span class="cm">,</span> <span class="n">0</span><span class="s">]</span><span class="cm">,</span>
    <span class="s">[</span><span class="n">1</span><span class="cm">,</span> <span class="n">5</span><span class="cm">,</span> <span class="n">2</span><span class="cm">,</span> <span class="n">5</span><span class="cm">,</span> <span class="n">9</span><span class="cm">,</span> <span class="n">5</span><span class="s">]</span><span class="cm">,</span>  <span class="c"># not sequence, not treble, just repeat 5</span>
    <span class="s">[</span><span class="n">3</span><span class="cm">,</span> <span class="n">4</span><span class="cm">,</span> <span class="n">5</span><span class="cm">,</span> <span class="n">6</span><span class="cm">,</span> <span class="n">5</span><span class="cm">,</span> <span class="n">5</span><span class="s">]</span><span class="cm">,</span>  <span class="c"># analogous to J555+5 his nobs Cribbage 29</span>
                         <span class="c"># imperfect as should get 3&times;5 and Seq:4 either way?</span>
    <span class="s">[</span><span class="n">3</span><span class="cm">,</span> <span class="n">4</span><span class="cm">,</span> <span class="n">5</span><span class="cm">,</span> <span class="n">5</span><span class="cm">,</span> <span class="n">5</span><span class="cm">,</span> <span class="n">6</span><span class="s">]</span><span class="cm">,</span>  <span class="c"># analogous to J555+5 his nobs Cribbage 29</span>
     <span class="s">)</span><span class="sc">;</span>
 
<span class="k">push</span> <span class="i">@Samples</span><span class="cm">,</span> <span class="i">random_code</span><span class="s">(</span><span class="s">)</span> <span class="k">for</span> <span class="n">0</span>..<span class="s">(</span><span class="i">$N</span> - <span class="s">(</span><span class="n">1</span>+ <span class="k">scalar</span> <span class="i">@Samples</span><span class="s">)</span><span class="s">)</span><span class="sc">;</span>
<span class="k">say</span> <span class="k">scalar</span> <span class="i">@Samples</span><span class="sc">;</span>

<span class="k">my</span> <span class="i">$nothings</span>=<span class="n">0</span><span class="sc">;</span>

<span class="k">for</span> <span class="k">my</span> <span class="i">$sample</span> <span class="s">(</span><span class="i">@Samples</span><span class="s">)</span><span class="s">{</span>
    <span class="c"># say $sample-&gt;@*;</span>
    <span class="k">my</span> <span class="i">$hand</span> = <span class="i">hand</span><span class="s">(</span><span class="i">$sample</span><span class="s">)</span><span class="sc">;</span>
    <span class="k">say</span> <span class="i">$sample</span><span class="i">-&gt;@*</span><span class="cm">,</span> <span class="q">&quot; = $hand ;&quot;</span><span class="sc">;</span>
    <span class="i">$nothings</span> ++ <span class="k">if</span> <span class="i">$hand</span> <span class="k">eq</span> <span class="q">&#39;nothing&#39;</span><span class="sc">;</span>
<span class="s">}</span>

<span class="k">say</span> <span class="q">&quot;$nothings nothings; &quot;</span><span class="cm">,</span> <span class="i">$nothings</span>/<span class="i">$N</span> <span class="sc">;</span>


<a name="hand-"></a><span class="k">sub </span><span class="m">hand</span><span class="s">(</span><span class="i">$aref</span><span class="s">)</span><span class="s">{</span>
    <span class="k">my</span> <span class="i">%Names</span>=<span class="s">(</span><span class="n">2</span><span class="cm">=&gt;</span><span class="q">&#39;pair&#39;</span><span class="cm">,</span><span class="n">3</span><span class="cm">=&gt;</span><span class="q">&#39;three&#39;</span><span class="cm">,</span><span class="n">4</span><span class="cm">=&gt;</span><span class="q">&#39;four&#39;</span><span class="cm">,</span><span class="n">5</span><span class="cm">=&gt;</span><span class="q">&#39;five&#39;</span><span class="cm">,</span><span class="n">6</span><span class="cm">=&gt;</span><span class="q">&#39;six&#39;</span><span class="cm">,</span><span class="n">0</span><span class="cm">=&gt;</span><span class="q">&#39;nought&#39;</span><span class="cm">,</span><span class="n">1</span><span class="cm">=&gt;</span><span class="q">&#39;single&#39;</span><span class="cm">,</span><span class="s">)</span><span class="sc">;</span>

    <span class="k">my</span> <span class="i">$String</span> = <span class="k">join</span> <span class="q">q()</span><span class="cm">,</span> <span class="i">$aref</span><span class="i">-&gt;@*</span><span class="sc">;</span>
    <span class="k">my</span> <span class="i">@Cards</span> = <span class="k">sort</span> <span class="i">$aref</span><span class="i">-&gt;@*</span><span class="sc">;</span>
    <span class="k">my</span> <span class="i">@Scores</span><span class="sc">;</span>


    <span class="c"># repeat of ..xxx.. or xy..xyp</span>
    <span class="k">my</span> <span class="s">(</span><span class="i">$one</span><span class="cm">,</span> <span class="i">$two</span><span class="cm">,</span> <span class="i">$three</span><span class="s">)</span> = <span class="s">(</span><span class="i">$String</span> =~ <span class="q">m{ ((\d)\g{2}+) | (\d{2,}).*\g{3}  }xism</span>  <span class="s">)</span><span class="sc">;</span> 
    <span class="c">#                    say &quot;## &#39;$String&#39; : (($two)$one) | ($three) &quot;; # debug</span>
    <span class="k">my</span> <span class="i">$rep</span> = <span class="i">$one</span> || <span class="i">$two</span> || <span class="i">$three</span> || <span class="q">&#39;&#39;</span><span class="sc">;</span>
    <span class="k">push</span> <span class="i">@Scores</span><span class="cm">,</span> <span class="q">&quot;rep:@{[length $rep]}:$rep&quot;</span> <span class="k">if</span> <span class="i">$rep</span><span class="sc">;</span>

    <span class="k">my</span> <span class="i">$seq</span> = <span class="i">longest_seq</span><span class="s">(</span><span class="i">$String</span><span class="s">)</span><span class="sc">;</span>
    <span class="k">push</span> <span class="i">@Scores</span><span class="cm">,</span> <span class="q">&quot;seq:$seq&quot;</span> <span class="k">if</span> <span class="i">$seq</span><span class="sc">;</span>

    <span class="k">my</span> <span class="i">%Count</span><span class="sc">;</span>
    <span class="i">$Count</span>{<span class="i">$_</span>}++ <span class="k">for</span> <span class="i">@Cards</span><span class="sc">;</span>
    <span class="c"># say  grep {$_ ne 1} values %Count;</span>
    <span class="k">push</span> <span class="i">@Scores</span><span class="cm">,</span> <span class="i">$_</span> <span class="k">for</span> <span class="k">map</span> <span class="s">{</span> <span class="i">$Names</span>{<span class="i">$_</span>} <span class="s">}</span> <span class="k">grep</span> <span class="s">{</span><span class="i">$_</span> <span class="k">ne</span> <span class="n">1</span><span class="s">}</span> <span class="k">values</span> <span class="i">%Count</span><span class="sc">;</span>

    <span class="k">return</span> <span class="q">&#39;nothing&#39;</span> <span class="k">unless</span> <span class="i">@Scores</span><span class="sc">;</span>

    <span class="k">return</span> <span class="k">join</span> <span class="q">q(,)</span><span class="cm">,</span> <span class="i">@Scores</span><span class="sc">;</span>

<span class="s">}</span>

<span class="c"># find longest sequence</span>
<a name="longest_seq-"></a><span class="k">sub </span><span class="m">longest_seq</span> <span class="s">(</span><span class="i">$string</span><span class="s">)</span><span class="s">{</span>
    <span class="c"># prefers ascending sequence to a longer descending or arithmetic skip seq</span>
    <span class="c"># although neither Poker nor Cribbage allows sequence of TWO, </span>
    <span class="c"># nor arithmetic skips of 2,3,4,</span>
    <span class="c"># optionally allowed those here as they&#39;re human patterns.</span>
    <span class="c">#</span>
    <span class="c"># Allowing descending, skip, length 2 nearly obliterates nothings!</span>
    <span class="c"># (from 1 nothing in ~8, to 1 nothing in ~50)</span>
    <span class="k">my</span> <span class="i">$MIN_SEQ</span>   = <span class="n">2</span><span class="sc">;</span>
    <span class="k">my</span> <span class="i">$ALLOW_ALT</span> = <span class="n">1</span><span class="sc">;</span>
    <span class="k">my</span> <span class="i">$main_sequence</span> = <span class="q">&#39;0123456789012345&#39;</span><span class="sc">;</span> <span class="c"># master; allow for around-the-corner seqs</span>
    <span class="k">my</span> <span class="s">(</span><span class="i">$longest</span><span class="cm">,</span><span class="i">$iLeft</span><span class="cm">,</span><span class="i">$iRight</span><span class="s">)</span> = <span class="i">lcss</span><span class="s">(</span><span class="i">$main_sequence</span><span class="cm">,</span> <span class="i">$string</span><span class="s">)</span><span class="sc">;</span>

    <span class="k">return</span> <span class="k">length</span><span class="s">(</span><span class="i">$longest</span><span class="s">)</span>.<span class="q">&quot;:$longest&quot;</span>
        <span class="k">if</span>  <span class="i">$longest</span>
        <span class="k">and</span> <span class="k">length</span><span class="s">(</span><span class="i">$longest</span><span class="s">)</span> &gt;= <span class="i">$MIN_SEQ</span> <span class="sc">;</span>

    <span class="k">return</span> <span class="k">unless</span> <span class="i">$ALLOW_ALT</span><span class="sc">;</span>

    <span class="k">my</span> <span class="i">$alt_sequence</span> = <span class="q">&#39;9876543210 024680 13579 0369 048&#39;</span><span class="sc">;</span>
    <span class="s">(</span><span class="i">$longest</span><span class="cm">,</span><span class="i">$iLeft</span><span class="cm">,</span><span class="i">$iRight</span><span class="s">)</span> = <span class="i">lcss</span><span class="s">(</span><span class="i">$alt_sequence</span><span class="cm">,</span> <span class="i">$string</span><span class="s">)</span><span class="sc">;</span>
    <span class="k">return</span> <span class="k">length</span><span class="s">(</span><span class="i">$longest</span><span class="s">)</span>.<span class="q">&quot;:$longest&quot;</span>
        <span class="k">if</span>  <span class="i">$longest</span>
        <span class="k">and</span> <span class="k">length</span><span class="s">(</span><span class="i">$longest</span><span class="s">)</span> &gt;= <span class="i">$MIN_SEQ</span> <span class="sc">;</span>


    <span class="k">return</span> <span class="sc">;</span>
<span class="s">}</span>

<span class="c">## Pick a random 6 digit code, draw with replacement</span>
<a name="random_code-"></a><span class="k">sub </span><span class="m">random_code ()</span><span class="s">{</span>
   <span class="k">return</span> <span class="s">[</span> <span class="k">map</span> <span class="s">{</span><span class="i">random_int_between</span><span class="s">(</span><span class="n">0</span><span class="cm">,</span><span class="n">9</span><span class="s">)</span><span class="s">}</span> <span class="n">1</span>..<span class="n">6</span> <span class="s">]</span> <span class="sc">;</span>
<span class="s">}</span>

<span class="c"># from perlfaq4, modified for signatures</span>
<a name="random_int_between-"></a><span class="k">sub </span><span class="m">random_int_between</span> <span class="s">(</span><span class="i">$min</span><span class="cm">,</span> <span class="i">$max</span><span class="s">)</span> <span class="s">{</span>
    <span class="c"># Assumes that the two arguments are integers themselves!</span>
    <span class="k">return</span> <span class="i">$min</span> <span class="k">if</span> <span class="i">$min</span> == <span class="i">$max</span><span class="sc">;</span>
    <span class="s">(</span><span class="i">$min</span><span class="cm">,</span> <span class="i">$max</span><span class="s">)</span> = <span class="s">(</span><span class="i">$max</span><span class="cm">,</span> <span class="i">$min</span><span class="s">)</span>  <span class="k">if</span>  <span class="i">$min</span> &gt; <span class="i">$max</span><span class="sc">;</span>
    <span class="k">return</span> <span class="i">$min</span> + <span class="k">int</span> <span class="k">rand</span><span class="s">(</span><span class="n">1</span> + <span class="i">$max</span> - <span class="i">$min</span><span class="s">)</span><span class="sc">;</span>
<span class="s">}</span>
<a name="EOF-"></a></pre>
</body>
</html>
